Configuration Guides
Cisco Fabric Manager IP Services Configuration Guide
Bias-Free Language
Book Contents
Download
Print
Updated:
February 25, 2010
Chapter: Configuring the SAN Extension Tuner
Chapter Contents

The SAN Extension Tuner (SET) feature is unique to the Cisco MDS 9000 Family of switches. This feature helps you optimize FCIP performance by generating either direct access (magnetic disk) or sequential access (magnetic tape) SCSI I/O commands and directing such traffic to a specific virtual target. You can specify the size of the test I/O transfers and how many concurrent or serial I/Os to generate while testing. The SET reports the resulting I/Os per second (IOPS) and I/O latency, which helps you determine the number of concurrent I/Os needed to maximize FCIP throughput.
This chapter includes the following sections:
•About the SAN Extension Tuner
•License Prerequisites
•Configuring the SAN Extension Tuner
•Using the SAN Extension Tuner Wizard
•Default Settings
About the SAN Extension Tuner
The SAN extension tuner (SET) feature is unique to the Cisco MDS 9000 Family of switches. This feature helps you optimize FCIP performance by generating either direct access (magnetic disk) or sequential access (magnetic tape) SCSI I/O commands and directing such traffic to a specific virtual target. Applications such as remote copy and data backup use FCIP over an IP network to connect across geographically distributed SANs. SET is implemented in IPS ports. When enabled, this feature can be used to generate SCSI I/O commands (read and write) to the virtual target based on your configured options.
Note SAN Extension Tuner is not supported on the Cisco Fabric Switch for HP c-Class BladeSystem, the Cisco Fabric Switch for IBM BladeCenter, and 16-Port Storage Services Node (SSN-16).
Note As of Cisco MDS SAN-OS Release 3.3(1a), SAN Extension Tuner is supported on the Multiservice Module (MSM) and the Multiservice Modular Switch.
Applications such as remote copy and data backup use FCIP over an IP network to connect across geographically distributed SANs. To achieve maximum throughput performance across the fabric, you can tune the following configuration parameters:
•The TCP parameters for the FCIP profile (see "Window Management" section on page 2-19 for more information).
•The number of concurrent SCSI I/Os generated by the application.
•The transfer size used by the application over an FCIP link.
SET is implemented in IPS ports. When enabled, this feature can be used to generate SCSI I/O commands (read and write) to the virtual target based on your configured options (see Figure 3-1).
Figure 3-1 SCSI Command Generation to the Virtual Target
The SET feature assists with tuning by generating varying SCSI traffic workloads. It also measures throughput and response time per I/ O over an FCIP link.
Before tuning the SAN fabric, be aware of the following guidelines:
•Following these implementation details:
–The tuned configuration is not persistent.
–The virtual N ports created do not register FC4 features supported with the name server. This is to avoid the hosts in the SAN from discovering these N ports as regular initiators or targets.
–Login requests from other initiators in the SAN are rejected.
–The virtual N ports do not implement the entire SCSI suite; it only implements the SCSI read and write commands.
–Tuner initiators can only communicate with tuner targets.
•Verify that the Gigabit Ethernet interface is up at the physical layer (GBIC and Cable connected—an IP address is not required).
•Enable iSCSI on the switch (no other iSCSI configuration is required).
•Enable the interface (no other iSCSI interface configuration is required)
See "Creating iSCSI Interfaces" section on page 4-6 for more information.
•Configure the virtual N ports in a separate VSAN or zone as required by your network.
•Be aware that a separate VSAN with only virtual N ports is not required, but is recommended as some legacy HBAs may fail if logins to targets are rejected.
•Do not use same Gigabit Ethernet interface to configure virtual N ports and FCIP links—use different Gigabit Ethernet interfaces. While this is not a requirement, it is recommended as the traffic generated by the virtual N ports may interfere with the performance of the FCIP link.
SAN Extension Tuner Setup
Figure 3-2 provides a sample physical setup in which the virtual N ports are created on ports that are not a part of the FCIP link for which the throughput and latency is measured.
Figure 3-2 N Port Tuning Configuration Physical Example
Figure 3-3 provides a sample logical setup in which the virtual N ports are created on ports that are not a part of the FCIP link for which the throughput and latency is measured.
Figure 3-3 Logical Example of N Port Tuning for a FCIP Link
Data Pattern
By default, an all-zero pattern is used as the pattern for data generated by the virtual N ports. You can optionally specify a file as the data pattern to be generated by selecting a data pattern file from one of three locations: the bootflash: directory, the volatile: directory, or the slot0: directory. This option is especially useful when testing compression over FCIP links. You can also use Canterbury corpus or artificial corpus files for benchmarking purposes.
License Prerequisites
To use the SET, you need to obtain the SAN_EXTN_OVER_IP license (see the Cisco Family NX-OS Licensing Guide).
Configuring the SAN Extension Tuner
This section includes the following topics:
•Tuning the FCIP Link
Tuning the FCIP Link
To tune the required FCIP link, follow these steps:
Step 1 Configure the nWWN for the virtual N ports on the switch.
Step 2 Enable iSCSI on the interfaces on which you want to create the N ports.
Step 3 Configure the virtual N ports on either side of the FCIP link.
Step 4 Ensure that the virtual N ports are not visible to real initiators in the SAN. You can use zoning (see the Cisco Fabric Manager Fabric Configuration Guide) to segregate the real initiators. Ensure that the zoning configuration is set up to allow the virtual N-ports to communicate with each other.
Step 5 Start the SCSI read and write I/Os.
Step 6 Add more N ports (as required) to other Gigabit Ethernet ports in the switch to obtain maximum throughput. One scenario that may require additional N ports is if you use FCIP PortChannels.
Using the SAN Extension Tuner Wizard
Use the SAN Extension Tuner wizard to perform the these tasks:
•Configuring nWWN ports
•Enabling iSCSI
•Configuring Virtual N ports
•Assigning SCSI read and write CLI commands
•Assigning SCSI tape read and write CLI commands
•Configuring a data pattern for SCSI commands
To tune the required FCIP link using the SAN Extension Tuner Wizard in Fabric Manager, follow these steps:
Step 1 Right-click a valid FCIP link in the Fabric pane, and then select SAN Extension Tuner from the drop-down list. You can also highlight the link and choose Tools > Other > SAN Extension Tuner.
You see the Select Ethernet Port Pair dialog box (see Figure 3-4).
Figure 3-4 Select Ethernet Port Pair Dialog Box
Step 2 Select the Ethernet port pairs that correspond to the FCIP link you want to tune and click Next.
Note The Ethernet ports you select should be listed as down.
You see the Specify Parameters dialog box (see Figure 3-5).
Step 3 Create and activate a new zone to ensure that the virtual N ports are not visible to real initiators in the SAN by clicking Yes to the zone creation dialog box.
Figure 3-5 Specify Parameters Dialog Box
Step 4 (Optional) Change the default settings for the transfer data size and the number of concurrent SCSI read and write commands as follows:
a. Set Transfer Size to the number of bytes that you expect your applications to use over the FCIP link.
b. Set Read I/0 to the number of concurrent SCSI read commands you expect your applications to generate over the FCIP link.
c. Set Write I/0 to the number of concurrent outstanding SCSI write commands you expect your applications to generate over the FCIP link.
Note There is only one outstanding I/O at a time to the virtual N port that emulates the tape behavior.
d. Check the Use Pattern File check box and select a file that you want to use to set the data pattern that is generated by the SAN extension tuner. See the "Data Pattern" section.
Step 5 Click Next.
You see the Results dialog box (see Figure 3-6).
Figure 3-6 Results Dialog Box
Step 6 Click Start to start the tuner. The tuner sends a continuous stream of traffic until you click Stop.
Step 7 Click Show to see the latest tuning statistics. You can select this while the tuner is running or after you stop it.
Step 8 Click Stop to stop the SAN extension tuner.
Default Settings
Table 3-1 lists the default settings for tuning parameters.
Table 3-1 Default Tuning Parameters 
Parameters
Default
Tuning
Disabled
Transfer ready size
Same as the transfer size in the SCSI write command
Outstanding I/Os
1
Number of transactions
1
Data generation format
All-zero format
File mark frequency
0

Was this Document Helpful?
Yes No
Feedback
Contact Cisco
Open a Support Case
(Requires a Cisco Service Contract)
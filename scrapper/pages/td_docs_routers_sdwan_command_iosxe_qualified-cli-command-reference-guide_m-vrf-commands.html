Command References
Cisco IOS XE SD-WAN Qualified Command Reference
Bias-Free Language
Book Contents
Download
Print
Updated:
January 29, 2021
Chapter: VRF Commands
Chapter Contents
address-family ipv4
address-family ipv6
description (VRF definition)
ip vrf
rd (VPLS)
redistribute vrf
route-replicate (VRF address family)
route-target
service tcp-keepalives-in
service tcp-keepalives-out
service tcp-small-servers
service udp-small-servers
vrf definition
address-family ipv4
To set an address family ipv4 in vrf configuration mode use the address-family ipv4 command. To remove the IPv4 address-family, use the no form of this command.
address-family ipv4 { bgp [next-hop ] | export [map ] | import [map ] | maximum [routes ] | mdt [ auto-discovery | data | default | log-reuse | mtu | overlay | preference ] | route-replicate [ from | recursion-policy ] | route-target [ export | import ] }
no address-family ipv4 { bgp [next-hop ] | export [map ] | import [map ] | maximum [routes ] | mdt [ auto-discovery | data | default | log-reuse | mtu | overlay | preference ] | route-replicate [ from | recursion-policy ] | route-target [ export | import ] }
Syntax Description
bgp
A standardized exterior gateway protocol designed to exchange routing and reachability information.
next-hop
IP address of the next hop in the traffic flow.
export
Allows vrf table to be exported to the global table or another vrf.
map
VRF definition or global table.
import
Allows global table or another vrf table to be imported to vrf.
map
VRF definition or global table.
maximum
Specifies the max number of routes.
routes
<0 – 42949677295>
mdt
Specifies an IPv4 multicast distribution tree (MDT) address family session.
auto-discovery
Enables BGP MVPN discovery for GRE in multicast code.
data
Specifies a range of addresses to be used in the data multicast distribution tree (MDT) pool.
default
Configures a default multicast distribution tree (MDT) group for a vrf.
log-reuse
Enables the recording of data multicast distribution tree (MDT) reuse.
mtu
Defines the largest size of packets that an interface can transmit.
overlay
Specifies a protocol as the overlay.
preference
Specifies a preference for a particular MDT type (MLDP or PIM).
route-replicate Replicates routes into the base topology within the specified address family.
from
Defines a vrf where network resides.
recursion-policy
route-target
Specifies the target where routes are ether sent or received.
export
Allows a vrf table to be exported to the global table or another vrf.
import
Allows a global table or another vrf table to be imported to vrf.
Command Default
None
Command Modes
VRF configuration (config-vrf)
Command History
Release Modification
Cisco IOS XE Release 17.2.1v
Command qualified for use in Cisco SD-WAN Manager CLI templates.
Usage Guidelines
The address-family ipv4 command under the vrf definition allows you to configure routing sessions and other related configuration commands.
Example
The following example shows the how to configure address-family ipv4 prefixes from vrf 77.
Device(config)# vrf definition 77
Device(config-vrf)# address-family ipv4
Device(config-ipv4)# exit-address-family
address-family ipv6
To set an address family ipv6 in vrf configuration mode use the address-family ipv6 command. To remove the IPv6 address-family, use the no form of this command.
address-family ipv6 { bgp [next-hop ] | import [map ] | mdt [ auto-discovery | data | default | log-reuse | mtu | overlay | preference ] }
no address-family ipv6 { bgp [next-hop ] | import [map ] | mdt [ auto-discovery | data | default | log-reuse | mtu | overlay | preference ] }
Syntax Description
bgp
A standardized exterior gateway protocol designed to exchange routing and reachability information.
next-hop
IP address of the next hop in the traffic flow.
import
Allows global table or another vrf table to be imported to vrf.
map
VRF definition or global table.
mdt
Specifies an IPv6 multicast distribution tree (MDT) address family session.
auto-discovery
Enables BGP MVPN discovery for GRE in multicast code.
data
Specifies a range of addresses to be used in the data multicast distribution tree (MDT) pool.
default
Configures a default multicast distribution tree (MDT) group for a vrf.
log-reuse
Enables the recording of data multicast distribution tree (MDT) reuse.
mtu
Defines the largest size of packets that an interface can transmit.
overlay
Specifies a protocol as the overlay.
preference
Specifies a preference for a particular MDT type (MLDP or PIM).
Command Default
None
Command Modes
VRF configuration (config-vrf)
Command History
Release Modification
Cisco IOS XE Release 17.2.1v
Command qualified for use in Cisco SD-WAN Manager CLI templates.
Usage Guidelines
The address-family ipv6 command under the vrf definition allows you to configure routing sessions and other related configuration commands.
Example
The following example shows the how to configure address-family ipv6 prefixes from vrf 77.
Device(config)# vrf definition 77
Device(config-vrf)# address-family ipv6
Device(config-ipv6)# exit-address-family
description (VRF definition)
To assign a helpful description to a virtual routing and forwarding (VRF) instance, use the description command in VRF definition configuration mode. To remove the description, use the no form of this command.
description string
no description
Syntax Description
string
Description of a VRF (up to 244 characters).
Command Default
This command has no default arguments or keywords.
Command Modes
VRF definition configuration mode (config-vrf)
Command History
Release
Modification
Cisco IOS XE Release 17.2.1v
Qualified for use in Cisco vManage CLI templates.
Usage Guidelines
For the usage guideline, see description (VRF definition)
Device(config)# vrf definition 1
Device(config-vrf)# description vrf instance 1
ip vrf
To define a VPN routing and forwarding (VRF) instance and to enter VRF configuration mode, use the ip vrf command in global configuration mode. To remove a VRF instance, use the no form of this command.
Supported Parameters
vrf-name
Name assigned to a VRF.
Command History
Release Modification
Cisco IOS XE Release 17.6.1a
Command qualified for use in Cisco SD-WAN Manager CLI templates.
Usage Guidelines
For more information about this command, see the Cisco IOS XE ip vrf command.
The following example shows how to import a route map to a VRF instance named VPN1:
Router(config)# ip vrf vpn1
Router(config-vrf)# rd 100:2
Router(config-vrf)# route-target both 100:2
Router(config-vrf)# route-target import 100:1
rd (VPLS)
To specify a route distinguisher (RD) to distribute endpoint information in a Virtual Private LAN Service (VPLS) configuration, use the rd command in L2 VFI configuration or VFI autodiscovery configuration mode. To remove the manually configured RD and return to the automatically generated RD, use the no form of this command.
rd {autonomous-system-number:nn | ip-address:nn}
no rd {autonomous-system-number:nn | ip-address:nn}
Syntax Description
autonomous-system-number:nn
Specifies a 16-bit autonomous system number (ASN) and 32-bit arbitrary number. The ASN does not have to match the local autonomous system number.
ip-address:nn
Specifies a 32-bit IP address and a 16-bit arbitrary number. Only IPv4 addresses are supported.
Command Default
VPLS autodiscovery automatically generates a RD using the Border Gateway Protocol (BGP) autonomous system number and the configured virtual forwarding instance (VFI) VPN ID.
Command Modes
VRF definition configuration mode (config-vrf)
Command History
Release
Modification
Cisco IOS XE Release 17.2.1v
Qualified for use in Cisco vManage CLI templates.
Usage Guidelines
For the usage guideline, see rd (VPLS)
Device(config)# vrf definition 1
Device(config-vrf)# rd 1:2
redistribute vrf
To redistribute routes that are replicated between global VRF and service VPN and between inter-service VPNs, use the redistribute vrf command in router configuration mode. To stop such redistribution, use the no form of this command.
redistribute vrf vrf-name protocol [ metric bandwidth-metric delay-metric reliability-metric effective-bandwidth-metric mtu-bytes ] subnets [ route-map route-map-name ]
no redistribute vrf vrf-name protocol subnets [ metric bandwidth-metric delay-metric reliability-metric effective-bandwidth-metric mtu-bytes ] [ route-map route-map-name ]
Syntax Description
vrf-name
The name of the VRF from which routes are replicated.
protocol
Type of protocol of the source route. Some of the keywords require an argument. The valid keywords and arguments are:
bgp autonomous-system-number : Border Gateway Protocol (BGP).
connected : Connected routes.
eigrp autonomous-system-number : Enhanced Interior Gateway Routing Protocol (EIGRP).
ospf process-id : Open Shortest Path First (OSPF).
static : Static routes.
nhrp : Next Hop Resolution Protocol (NHRP) routes.
route-map-name
(Optional) Name of a route map that filters out routes that shouldn’t be redistributed back to the original protocol.
metric
(Optional) Specifies the metric for redistributed routes.
bandwidth-metric
(Optional) Maximum bandwidth of the route in kilobits per second (kb/s). The range is 1 to 4294967295.
delay-metric
(Optional) EIGRP route delay metric in microseconds. The range is 1 to 4294967295.
reliability-metric
(Optional) EIGRP reliability metric. The range is 0 to 255.
An EIGRP metric of 255 signifies 100 percent reliability.
effective-bandwidth- metric
(Optional) Effective bandwidth of the route. The range is 1 to 255.
The effective bandwidth of 255 denotes 100 percent load.
mtu-bytes
(Optional) Smallest allowed value for the maximum transmission unit (MTU) in bytes. The range is 1 to 65535.
subnets
(Optional) Specifies redistribution of routes into OSPF. When routes are redistributed into OSPF, only routes that are not subnetted are redistributed if the subnets keyword is not specified. This is not applicable for connected protocol type. This can be configured for bgp, nhrp, ospf, ospfv3, and static protocol types. By default, no subnets are defined.
Command Default
No routes are redistributed.
Command Modes
Router topology configuration (config-router-af-topology)
Router configuration (config-router)
Command History
Release Modification
Cisco IOS XE Release 17.5.1a
Command qualified for use in Cisco SD-WAN Manager CLI templates.
Cisco IOS XE Release 17.6.1a
Support is added for BGP as the destination protocol when redistributing between the global VRF and service VPNs.
Cisco IOS XE Release 17.9.1a
Support is added for redistrbuting between service VRFs on the same edge device site.
The following example shows how to redistribute global VRF routes into VRF EIGRP that were replicated from global BGP to service VPN:
Device(config)# vrf definition 1
Device(config-vrf)# address-family ipv4
Device(config-ipv4)# route-replicate from vrf global unicast bgp 56
Device(config-ipv4)# exit-address-family
Device(config-vrf)# exit
Device(config)# router eigrp test
Device(config-router)# ! Redistribute routes that were replicated from vrf global into eigrp.
Device(config-router)# address-family ipv4 unicast vrf red autonomous-system 1
Device(config-router-af)# topology base
Device(config-router-af-topology)# redistribute vrf global bgp 50000 metric 1000000 10 255 1 1500
The following example shows how to redistribute global VRF routes into VRF BGP that were replicated from global BGP to Service VPN:
Device(config)# vrf definition 102
Device(config-vrf)# address-family ipv4
Device(config-ipv4)# route-replicate from vrf 102 unicast global bgp 50000
Device(config-ipv4)# exit-address-family
Device(config-vrf)# exit
Device(config)# router bgp 50000
Device(config-router)# ! Redistribute routes that were replicated from service vrf to bgp.
Device(config-router)# address-family ipv4 vrf 102
Device(config-router-af-topology)# redistribute vrf global bgp 50000 route-map BGP-route-map
The following example shows how to redistribute global VRF routes into VRF OSPF that were replicated from global BGP into VRF:
Device(config)# vrf definition 2
Device(config-vrf)# address-family ipv4
Device(config-ipv4)# route-replicate from vrf global unicast bgp 77
Device(config-ipv4)# exit-address-family
Device(config-vrf)# exit
Device(config)# router ospf 1 vrf test
Device(config-router)# ! Redistribute routes that were replicated from vrf global into ospf.
Device(config-router)# redistribute vrf global bgp 77
The following example shows how to redistribute routes via OSPF that were replicated from VRF 1:
Device(config)# vrf definition 2
Device(config-vrf)# rd 1:2
Device(config-vrf)# address-family ipv4
Device(config-ipv4)# route-replicate from vrf 1 unicast static route-map VRF1_TO_VRF2
Device(config-ipv4)# exit-address-family
Device(config)# router ospf 2 vrf 2
Device(config-router)# redistribute vrf 1 static route-map VRF1_TO_VRF2
route-replicate (VRF address family)
To replicate routes from another topology and Virtual Routing and Forwarding (VRF), use the route-replicate command in VRF address-family configuration mode. To stop replicating routes, use the no form of this command.
route-replicate from vrf source-vrf-name unicast protocol [ route-map map-tag ]
no route-replicate from vrf source-vrf-name unicast protocol [ route-map map-tag ]
Syntax Description
from
Specifies the topology where route replication is enabled.
vrf source-vrf-name
Specifies the name of the VRF from which routes are replicated.
unicast
Specifies a unicast SAFI.
protocol
Type of protocol of the source route. Some keywords require an argument. Valid keywords and arguments are:
bgp autonomous-system-number : Border Gateway Protocol (BGP).
connected : Connected routes.
eigrp autonomous-system-number : Enhanced Interior Gateway Routing Protocol (EIGRP).
ospf process-id : Open Shortest Path First (OSPF).
static : Static routes.
route-map map-tag
(Optional) Specifies the name of a route map that filters routes that shouldn’t be replicated.
Command Default
No routes are replicated.
Command Modes
VRF address family configuration (config-ipv4)
Command History
Release Modification
Cisco IOS XE Release 17.5.1a
Command qualified for use in Cisco SD-WAN Manager CLI templates.
Cisco IOS XE Release 17.9.1a
Support for route replication between service VPNs at the same edge device site.
Usage Guidelines
Route replication creates a link to a route in a routing information base (RIB) that is in a different VRF.
The following example redistributes global VRF BGP routes into VRF EIGRP that were replicated from VRF global into 1:
Device(config)# vrf definition 1
Device(config-vrf)# address-family ipv4
Device(config-ipv4)# route-replicate from vrf global unicast bgp 56
Device(config-ipv4)# exit-address-family
Device(config-vrf)# exit
Device(config)# router eigrp test
Device(config-router)# ! Redistribute routes that were replicated from vrf global into eigrp.
Device(config-router)# address-family ipv4 unicast vrf red autonomous-system 1
Device(config-router-af)# topology base
Device(config-router-af-topology)# redistribute vrf global bgp 56
The following example redistributes global VRF EIGRP routes into BGP that were replicated from VRF global:
Device(config)# vrf definition 1
Device(config-vrf)# address-family ipv4
Device(config-ipv4)# route-replicate from vrf global unicast eigrp 56
Device(config-ipv4)# exit-address-family
Device(config-vrf)# exit
Device(config)# router bgp test
Device(config-router)# address-family ipv4 unicast vrf 10
Device(config-router-af)# redistribute vrf global bgp 56
Device(config-router-af)# exit-address-family
The following example shows how to redistribute routes via OSPF that were replicated from VRF 1 into VRF 2:
Device(config)# vrf definition 2
Device(config-vrf)# rd 1:2
Device(config-vrf)# address-family ipv4
Device(config-ipv4)# route-replicate from vrf 1 unicast static route-map VRF1_TO_VRF2
Device(config-ipv4)# exit-address-family
Device(config)# router ospf 2 vrf 2
Device(config-router)# redistribute vrf 1 static route-map VRF1_TO_VRF2
route-target
To create a route-target extended community for a Virtual Private Network (VPN) routing and forwarding (VRF) instance, use the route-target command in VRF configuration or in VRF address family configuration mode. To disable the configuration of a route-target community option, use the no form of this command.
route-target [ export | import ] route-target-ext-community
no route-target [ export | import ] route-target-ext-community
Syntax Description
import
(Optional) Imports routing information from the target VPN extended community.
export
Optional) Exports routing information to the target VPN extended community.
route-target-ext-community
The route-target extended community attributes to be added to the VRF’s list of import, export, or both (import and export) route-target extended communities.
Command Default
A VRF has no route-target extended community attributes associated with it.
Command Modes
VRF definition configuration mode (config-vrf)
Release
Modification
Cisco IOS XE Release 17.2.1v
Qualified for use in Cisco vManage CLI templates.
Usage Guidelines
For the usage guideline, see route-target
Device(config)# vrf definition 1
Device(config-vrf)# default route-target export 101:3
Device(config)# vrf definition 1
Device(config-vrf)# default route-target import 102:3
service tcp-keepalives-in
To generate keepalive packets on idle incoming network connections (initiated by the remote host), use the service tcp-keepalives-in command in global configuration mode . To disable the keepalives, use the no form of this command.
service tcp-keepalives-in
no service tcp-keepalives-in
Syntax Description
This command has no arguments or keywords.
Command Default
Disabled
Command Modes
Global configuration
Command History
Release
Modification
Cisco IOS XE Release 17.3.1a
Command qualified for use in Cisco vManage CLI templates.
In the following example, keepalives on incoming TCP connections are generated:
Device(config)# service tcp-keepalives-in
 
service tcp-keepalives-out
To generate keepalive packets on idle outgoing network connections (initiated by a user), use the service tcp-keepalives-out command in global configuration mode . To disable the keepalives, use the no form of this command.
service tcp-keepalives-out
no service tcp-keepalives-out
Syntax Description
This command has no arguments or keywords.
Command Default
Disabled
Command Modes
Global configuration
Command History
Release
Modification
Cisco IOS XE Release 17.3.1a
Command qualified for use in Cisco vManage CLI templates.
In the following example, keepalives on outgoing TCP connections are generated:
Device(config)# service tcp-keepalives-out
 
service tcp-small-servers
To enable small TCP servers such as the Echo, use the service tcp-small-servers command in global configuration mode. To disable the TCP server, use the no form of this command.
service tcp-small-servers
no service tcp-small-servers
Command Default
TCP small servers are disabled.
Command Modes
Global configuration (config)
Command History
Release
Modification
Cisco IOS XE Release 17.3.1a
Command qualified for use in Cisco vManage CLI templates.
Usage Guidelines
For usage guidelines, see the Cisco IOS XE service tcp small servers command.
The following example shows how to enable small TCP servers:
Device(config)# service tcp-small-servers
service udp-small-servers
To enable small User Datagram Protocol (UDP) servers such as the Echo, use the service udp-small-servers command in global configuration mode. To disable the UDP server, use the no form of this command.
service udp-small-servers
no service udp-small-servers
Command Default
UDP small servers are disabled.
Command Modes
Global configuration (config)
Command History
Release
Modification
Cisco IOS XE Release 17.3.1a
Command qualified for use in Cisco vManage CLI templates.
Usage Guidelines
For usage guidelines, see the Cisco IOS XE service udp small servers command.
The following example shows how to enable small UDP:
Router(config)# service udp-small-servers
vrf definition
To configure a virtual routing and forwarding (VRF) routing-table instance and enter VRF configuration mode, use the vrf definition command in global configuration mode. To remove a VRF routing table, use the no form of this command.
vrf definition vrf-number
no vrf definition vrf-number
Syntax Description
vrf-number
Number assigned to a VRF.
Command Default
No VRFs are defined. No import or export lists are associated with a VRF. No route maps are associated with a VRF.
Command Modes
Global configuration (config)
Command History
Release
Modification
Cisco IOS XE Release 17.2.1v
Qualified for use in Cisco vManage CLI templates.
Usage Guidelines
For the usage guideline, see vrf definition
Device(config)# vrf definition 1
Was this Document Helpful?
Yes No
Feedback
Customers Also Viewed
Identify vEdge Certificate Expired on May 9, 2023
Cisco SD-WAN Getting Started Guide --- Install and Upgrade Cisco IOS XE Release 17.2.1r and Later
Cisco SD-WAN Getting Started Guide --- Cisco SD-WAN Overlay Network Bring-Up Process
+ Show 3 More
Contact Cisco
Open a Support Case
(Requires a Cisco Service Contract)
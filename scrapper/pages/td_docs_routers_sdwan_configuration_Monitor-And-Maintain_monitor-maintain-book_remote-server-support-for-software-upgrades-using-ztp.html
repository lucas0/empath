End-User Guides
Cisco SD-WAN Monitor and Maintain Configuration Guide
Bias-Free Language
Book Contents
Download
Print
Updated:
December 16, 2022
Chapter: Remote Server Support for ZTP Software Upgrade
Chapter Contents
Table 1. Feature History
Feature Name
Release Information
Description
Remote Server Support for ZTP Software Upgrade
Cisco IOS XE Release 17.10.1a
Cisco SD-WAN Controllers Release 20.10.1
This features introduces remote server support for upgrading the software of Cisco IOS XE SD-WAN devices at scale using Zero Touch Provisioning (ZTP). Upload the software upgrade images to Cisco vManage using a preferred remote server and then upgrade the respective devices.
Information About Remote Server Support for ZTP Upgrade
Benefits of Remote Server Support for ZTP Upgrade
Supported Devices for Remote Server Support for ZTP Upgrade
Prerequisites for Remote Server Support for ZTP Upgrade
Restrictions for Remote Server Support for ZTP Upgrade
Enable Enforce Software Version (ZTP)
Upload Device List
Use Cisco vManage to Configure and Upgrade a Device
Monitor the ZTP Software Install
Information About Remote Server Support for ZTP Upgrade
You can onboard and upgrade numerous Cisco IOS XE SD-WAN devices together, using the software images hosted on a remote server. The physical WAN edge onboard and upgrade options include the following:
Manual
Bootstrap
Automated deployment
In Cisco IOS XE Release 17.9.1a and earlier, the software upgrade images are hosted only on Cisco vManage. During the software upgrade process, the devices fetch the upgrade information from Cisco vManage to upgrade the devices with the latest software.
From Cisco IOS XE Release 17.10.1a, remote server support for ZTP upgrades enables you to upgrade Cisco IOS XE SD-WAN devices using the software images stored in a remote server. The remote server support for ZTP upgrade feature enables you to register a remote server with Cisco vManage and add locations of the software images that are present in the remote server to the Cisco vManage software repository. When you upgrade a device, the device downloads the new software image from the remote server, without overwhelming the Cisco vManage server.
Benefits of Remote Server Support for ZTP Upgrade
Enables you to upgrade Cisco IOS XE SD-WAN devices using software images stored on a remote server, thus removing the dependency on the Cisco vManage software repository.
Many software upgrade image file formats are supported.
Cisco vManage provides the devices that are being upgraded with the information they require to download the necessary software images from the servers hosting the images. The devices retrieve the images directly from the servers. This minimizes performance demands on Cisco vManage, as compared to storing images in the Cisco vManage software repository.
Supported Devices for Remote Server Support for ZTP Upgrade
Release
Supported Devices
Cisco IOS XE Release 17.10.1a
ASR 1000
ISR 1000
ISR 4000 series router models (with exception of ISR1100-4G/6G)
IR 1001
IR 8340
IR 8100
Ciso 8000 series router models
Cisco Catalyst Wireless Gateway CG113 Series
ASR 1001-X
Cisco 1100
Ciso ESR6300
Prerequisites for Remote Server Support for ZTP Upgrade
Ensure that a remote server is registered to the Cisco vManage Software Repository. For more information see, the section Register Remote Server.
Ensure that you add a new software image using the Remote Server (preferred) option. For more information see, the section Add Software Images to the Repository.

Note
Ensure that the Image Filename matches the Image Filename in the Remote Server Name field.
Make sure the device can reach the Cisco vBond Orchestrator, Cisco vManage, and Cisco vSmart controllers.
To be upgraded, a device must be in the Valid or the Staging Certificate state.
Restrictions for Remote Server Support for ZTP Upgrade
You cannot upgrade Cisco vManage along with devices that are present in a group upgrade operation. You must upgrade and reboot the only the Cisco vManage server.
The ZTP upgrade flow doesn't restart automatically when the devices are interrupted by an unforeseen manual device reload or a power failure.
The Enforce Software Version (ZTP) option is available only for Cisco IOS XE SD-WAN devices.
We recommend that you perform all software upgrades from Cisco vManage rather than from the CLI.
Remote server support for ZTP upgrades is available only through VPN-0.

Note
For software compatibility information, see Cisco SD-WAN Controller Compatibility Matrix and Server Recommendations.
Enable Enforce Software Version (ZTP)
From the Cisco vManage menu, choose Administration > Settings.
In the Administration Settings window, click Edit in the Enforce Software Version (ZTP) row.
Enable the software version for the corresponding device.
In the Image Location window, click the Remote Server radio button.
From the Remote Server Name drop-down list, choose a remote server.
From the Image Filename drop-down list, choose an image.
Click Save.
Upload Device List
You can upload a list of devices that you want to upgrade, to Cisco vManage.
From the Cisco vManage menu, choose Configuration > Devices.
Click Upload WAN Edge List.
Upload the .CSV file that you have created from the Sample CSV.
Check the Validate the uploaded vEdge List and send to controllers checkbox.
Click Upload.

Note
You can upload device lists to Cisco vManage using your Cisco Smart Account as well. For more information about enabling PnP Connect Sync see, Enable PnP Connect Sync.
Use Cisco vManage to Configure and Upgrade a Device
Devices in the overlay network that are managed by Cisco vManage must be configured using Cisco vManage in order to be upgraded.
Use the following steps to configure and upgrade a device, using Cisco vManage:
Create feature templates:
From the Cisco vManage menu, choose Configuration > Templates.
Click Feature Templates, and choose Add Templates.
Create device templates.
From the Cisco vManage menu, choose Configuration > Templates.
Click Device Templates, and choose Create Templates.
Attach device templates to individual devices.
From the Cisco vManage menu, choose Configuration > Templates.
Click Device Templates, and choose a template.
Click â€¦, and choose Attach Devices.
You can see the added device in the list of Available Devices list. Send the particular device to the Selected Devices window using the Right arrow button.
Click Attach.
In the Device Template window, click ... to update the device template by entering the following parameters:
Field
Description
Status
Displays the current status of the device template.
Chassis Number
Displays the chassis number of the device.
System IP
Displays the system IP address, if applicable.
Host Name
Displays the host name, if applicable.
DNS Address (vpn_dns_primary)
Enter the DNS address.
Host Name
Enter the host name.
System IP
Enter the system IP address.
Site ID
Enter the site ID.
Click Update. and then click Next.
After the device template is added, select the device template and click Configure Devices.
The Config Preview is displayed.
Click Configure Devices.
You are routed to the Task List window, where you can see the status of the configuration.
The configuration is attached to the device once the device is online.
Cisco vManage creates a task for this software upgrade through the ZTP server, and you can monitor the status of the upgrade using the Task List window.
Monitor the ZTP Software Install
In Cisco vManage, click the task list icon at the top-right corner of the window.
The task list shows open software installation tasks, if any, and indicates the status of these tasks.

Note
Cisco vManage pushes the device template to a device only after the software upgrade process is complete. You can monitor the status of the software upgrade using the Tasks window.
Was this Document Helpful?
Yes No
Feedback
Contact Cisco
Open a Support Case
(Requires a Cisco Service Contract)